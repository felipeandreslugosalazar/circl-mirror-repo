<link href='https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.css' rel='stylesheet' />
<div class="header-show-page">

  <div class="row">
    <div class="col-6 col-md-4 text-show">
      <p class="show-header"><%= @event.title %></p>
      <p class="date-show"><i class="far fa-calendar-alt fa-1x"></i> <%= @event.event_date.strftime("%-d %B %Y, %-l:%M%p") %></p>
      <p class="location-show"><i class="fas fa-map-marker-alt fa-1x"></i> <%= @event.location %></p>
      <p>You will meet & mingle with</p>
      <p>HOST:
        <% if @event.user.image.attached?  %>
          <%= cl_image_tag @event.user.image.key, class: "show-img-participant" %>
        <% else %>
          <img class="show-img-participant" src="https://source.unsplash.com/2LowviVHZ-E" alt="">
        <% end %>
      </p>
      <p>PARTICIPANTS :
        <% unless @accepted.empty? %>
          <% @accepted.each do |user| %>
            <% if user.image.attached?  %>
              <%= cl_image_tag user.image.key, class: "show-img-participant" %>
            <% else %>
              <img class="show-img-participant" src="https://source.unsplash.com/2LowviVHZ-E" alt="">
            <% end %>
          <% end %>
        <% end %>
      </p>
    </div>
    <div class="col-sm-6 col-md-8">
      <% if @event.image.attached?  %>
        <%= cl_image_tag @event.image.key, class: "card-img-show" %>
      <% else %>
        <img class="card-img-show" src="https://source.unsplash.com/PGnqT0rXWLs" alt="">
      <% end %>
    </div>
  </div>
</div>
<%= link_to "Back to all events", events_path, class: "btn-standard btn-show" %>
<% if @request_done %>
  <span class="btn btn-primary">
    <%= @request_done.status %>
  </span>
<% else %>
  <%= link_to "Ask to join", event_requests_path(@event), method: :post,  class: "btn btn-info" %>
<% end %>
<div class="desc-show-page">
  <p class="desc-show"><%= @event.description %></p>
</div>
<div class="map-style-show">
  <div id="map"
        style="width:100%; height: 400px;"
        data-markers="<%= @marker.to_json %>"
        data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>
</div>

<section class="comments-form-section">
  <div class="row">
    <div class="col-xs-12 col-sm-10 col-sm-offset-1">
      <h1>Questions about the event?</h1>
      <%= simple_form_for [@event, @comment] do |f| %>
        <%= f.input :content %>
        <%= f.submit class: 'btn btn-primary' %>
      <% end %>
    </div>
  </div>
</section>

<section class="comments-section">
  <% @event.comments.each do |comment| %>
    <div class="comments-card">  
      <div class="comments-card-items">
        <div class="comments-card-author">
          <div class="d-flex d-flex-column justify-content-center">
            <img src="https://ca.slack-edge.com/T02NE0241-UD0JHSHJB-9ffb88c541d4-512" class="avatar-large" />
          </div>
          <div>
            <h3><%= comment.user.first_name %>, <%= comment.user.age %></h3>
            <div class="comments-card-underline">
              <p><%= comment.created_at.strftime("%A, %b %d") %></p>
            </div>
          </div>
        </div>
        <div class="comments-card-text">
          <p><%= comment.content %></p>
        </div>
      </div>
    </div>
  <% end %>
</section>
